<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>角色详情</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="../../../layui/css/layui.css">
  <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
  <style type="text/css">
    body {
      padding: 10px;
      overflow: hidden;
    }
  </style>
</head>

<body>
  <div class="layui-col-md6">
    <div class="layui-card">
      <div class="layui-card-header">
        <label>菜单名称：</label>
        <div class="layui-inline">
          <input class="layui-input" id="txt_Title" autocomplete="off" placeholder="菜单名称">
        </div>
        <a class="layui-btn" onclick="active.search()">搜索</a>
      </div>
      <div class="layui-card-body" style="height: 390px;overflow: auto;">
        <div id="test7" class="demo-tree"></div>
      </div>
    </div>
  </div>

  <script src="../../../layui/layui.js"></script>
  <script src="../../../js/jquery.min.js"></script>
  <script src="../../../js/main.js"></script>

  <script type="text/javascript">
    var form = null;
    var layer = null;
    var tree = null;
    var treeList = [];
    // //模拟数据2
    // var data2 = [{
    //   title: '早餐',
    //   id: 1,
    //   children: [{
    //     checked: true,
    //     title: '油条',
    //     id: 2
    //   }, {
    //     disabled: true,
    //     title: '包子',
    //     id: 6
    //   }, {
    //     title: '豆浆',
    //     id: 7
    //   }]
    // }];
    layui.use(['form', 'layer', 'tree'], function () {
      form = layui.form;
      layer = layui.layer;
      tree = layui.tree;

      getAllMenu();

      getDetail();

      //开启复选框
      tree.render({
        id: 'test7',
        elem: '#test7',
        data: treeList,
        showCheckbox: true,
        oncheck: function (obj) {
          console.log(obj.checked); //得到当前节点是否选中
          console.log(obj.data); //得到当前点击的节点数据
          if (obj.data.children.length > 0) {
            //父级
          } else {
            //子级
          }
        }
      });
      // tree.setChecked('test7', true); //批量勾选 id 为 2、3 的节点

    });

    //获取菜单
    function getAllMenu() {
      ajaxGet({
        url: ApiService.SystemApi.APIService + "/Api/Common/GetSystemMenuTree",
        async: false,
        success: function (res) {
          if (res.code != 1) {
            return false;
          }
          treeList = res.data;
        }
      });
    }


    //获取详情
    function getDetail() {
      ajaxGet({
        url: ApiService.SystemApi.APIService + "/Api/SystemUserRole/GetRoleMenu",
        data: {
          rid: GetQueryString("id")
        },
        async: false,
        success: function (res) {
          if (res.code != 1) {
            return false;
          }
          tree.setChecked('test7', res.data);
        }
      });
    }

    //获取页面的值
    function getNowDetailJson() {
      return form.val('example');
    }
  </script>

</body>

</html>